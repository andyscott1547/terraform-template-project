# Terraform Template Project

This is a boilerplate template for a new terraform repository.

- [Overview](#overview)
  - [Diagrams](#diagrams)
  - [References](#references)
    - [GitHub Repositories](#github-repositories)
- [Prerequisites](#prerequisites)
- [Quick Start](#quick-start)
  - [Validate Terraform](#validate-terraform)
  - [Deploy from client machine](#deploy-from-client-machine)
  - [Troubleshooting Terraform](#troubleshooting-terraform)
  - [Destroy Environment](#destroy-environment)
- [Terraform Docs](#terraform-docs)

## Overview

### Diagrams

**Solution Architecture**

![Example](images/example.png)

### References

### GitHub Repositories

## Prerequisites

### Tooling
- Terraform
- Git
- AWS CLI
- Terraform-Docs
- TFLint
- TFEnv
- Checkov
- Pre-Commit

#### Configure AWS CLI
Run this command to quickly set and view your credentials, region, and output format\. The following example shows sample values\.

```
$ aws configure
AWS Access Key ID [None]: AKIAIOSFODNN7EXAMPLE
AWS Secret Access Key [None]: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
Default region name [None]: us-west-2
Default output format [None]: json
```

 For example, the files generated by the CLI for a default profile configured with `aws configure` looks similar to the following\.

**`~/.aws/credentials`**

```
[default]
aws_access_key_id=AKIAIOSFODNN7EXAMPLE
aws_secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
```

**`~/.aws/config`**

```
[default]
region=us-west-2
output=json
```

#### Install Required Version Of Terraform

```bash
tfenv install && tfenv use
```

## Quick Start

### Validate Terraform

Format
```bash
terraform fmt -recursive
```

Validate
```bash
terraform validate
```

Static Code Analysis
```bash
checkov -s -d .
```

Lint
```bash
tflint --init --loglevel=info
tflint --module --loglevel=info
```

Terraform-Docs
```bash
terraform-docs .
```

Pre-commit
```bash
pre-commit install
pre-commit run --all-files
```

### Deploy from client machine

Initialise the Terraform to install any modules and providers.

```bash
terraform init
```

Run terraform plan to check if any changes will be made to infrastructure.

```bash
terraform plan
```

Run terraform apply to deploy any changes to infrastructure.

```bash
terraform apply --auto-approve
```

### Troubleshooting Terraform

If the Terraform state is locked
```bash
terraform force-unlock <state-lock-id>
```

Listing available Terraform Workspaces
```bash
terraform workspace list
```

Upgrade Terraform Providers
```bash
terraform init --upgrade
git add .
git commit -m "upgrade terraform provider versions within pinned config"
git push
```

### Destroy Environment

To destroy a specific environment you need to run from a client machine.

Initialise the Terraform to install any modules and providers.

```bash
terraform init
```

Destroy the provisioned infrastructure in the target environment.

```bash
terraform destroy --auto-approve
```

## Terraform-Docs

<!-- BEGIN_TF_DOCS -->
{{ .Content }}
<!-- END_TF_DOCS -->

### Example Module

<!-- BEGIN_EXAMPLE_DOCS -->
{{ .Content }}
<!-- END_EXAMPLE_DOCS -->